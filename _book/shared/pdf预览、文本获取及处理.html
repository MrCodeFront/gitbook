
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>pdf预览、文本获取及处理 · CodeFront Document</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="lkf">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-accordion/accordion.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="PicGO安装与配置SMMS图床.html" />
    
    
    <link rel="prev" href="ng-alain.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    android
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../android/Android学习.html">
            
                <a href="../android/Android学习.html">
            
                    
                    Android学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../android/打包.html">
            
                <a href="../android/打包.html">
            
                    
                    打包
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../android/环境搭建.html">
            
                <a href="../android/环境搭建.html">
            
                    
                    环境搭建
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    angular
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../angular/ag-grid表格.html">
            
                <a href="../angular/ag-grid表格.html">
            
                    
                    ag-grid表格
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../angular/ag-grid表格配置及属性描述.html">
            
                <a href="../angular/ag-grid表格配置及属性描述.html">
            
                    
                    ag-grid表格配置及属性描述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../angular/i18n（国际化方案）.html">
            
                <a href="../angular/i18n（国际化方案）.html">
            
                    
                    i18n（国际化方案）
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../angular/Overlay遮罩.html">
            
                <a href="../angular/Overlay遮罩.html">
            
                    
                    Overlay遮罩
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../angular/zorro弹框拖拽.html">
            
                <a href="../angular/zorro弹框拖拽.html">
            
                    
                    zorro弹框拖拽
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../angular/内嵌视图、宿主视图.html">
            
                <a href="../angular/内嵌视图、宿主视图.html">
            
                    
                    内嵌视图、宿主视图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="../angular/动画.html">
            
                <a href="../angular/动画.html">
            
                    
                    动画
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="../angular/工作区.html">
            
                <a href="../angular/工作区.html">
            
                    
                    工作区
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="../angular/常用命令.html">
            
                <a href="../angular/常用命令.html">
            
                    
                    常用命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="../angular/开发问题.html">
            
                <a href="../angular/开发问题.html">
            
                    
                    开发问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.11" data-path="../angular/权限控制组件.html">
            
                <a href="../angular/权限控制组件.html">
            
                    
                    权限控制组件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.12" data-path="../angular/标签区域配置.html">
            
                <a href="../angular/标签区域配置.html">
            
                    
                    标签区域配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.13" data-path="../angular/样式.html">
            
                <a href="../angular/样式.html">
            
                    
                    样式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.14" data-path="../angular/相关资料.html">
            
                <a href="../angular/相关资料.html">
            
                    
                    相关资料
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.15" data-path="../angular/系统权限.html">
            
                <a href="../angular/系统权限.html">
            
                    
                    系统权限
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.16" data-path="../angular/自定义指令.html">
            
                <a href="../angular/自定义指令.html">
            
                    
                    自定义指令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.17" data-path="../angular/路由复用及自定义钩子方法.html">
            
                <a href="../angular/路由复用及自定义钩子方法.html">
            
                    
                    路由复用及自定义钩子方法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    antd
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../antd/栅格.html">
            
                <a href="../antd/栅格.html">
            
                    
                    栅格
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../antd/栅格布局组件排序及显示方案.html">
            
                <a href="../antd/栅格布局组件排序及显示方案.html">
            
                    
                    栅格布局组件排序及显示方案
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../antd/菜单.html">
            
                <a href="../antd/菜单.html">
            
                    
                    菜单
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../antd/虚拟滚动与拖拽排序.html">
            
                <a href="../antd/虚拟滚动与拖拽排序.html">
            
                    
                    虚拟滚动与拖拽排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../antd/表格勾选.html">
            
                <a href="../antd/表格勾选.html">
            
                    
                    表格勾选
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    cordova
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../cordova/cordova.html">
            
                <a href="../cordova/cordova.html">
            
                    
                    cordova
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../cordova/开发问题.html">
            
                <a href="../cordova/开发问题.html">
            
                    
                    开发问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../cordova/插件.html">
            
                <a href="../cordova/插件.html">
            
                    
                    插件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../cordova/软键盘监听及操作.html">
            
                <a href="../cordova/软键盘监听及操作.html">
            
                    
                    软键盘监听及操作
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    css
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../css/工具.html">
            
                <a href="../css/工具.html">
            
                    
                    工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../css/常用代码.html">
            
                <a href="../css/常用代码.html">
            
                    
                    常用代码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../css/常见问题.html">
            
                <a href="../css/常见问题.html">
            
                    
                    常见问题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" >
            
                <span>
            
                    
                    daily work
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../daily work/app打包及上传.html">
            
                <a href="../daily work/app打包及上传.html">
            
                    
                    app打包及上传
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../daily work/app条码.html">
            
                <a href="../daily work/app条码.html">
            
                    
                    app条码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../daily work/公司分享.html">
            
                <a href="../daily work/公司分享.html">
            
                    
                    公司分享
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../daily work/周报模板.html">
            
                <a href="../daily work/周报模板.html">
            
                    
                    周报模板
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../daily work/工作信息.html">
            
                <a href="../daily work/工作信息.html">
            
                    
                    工作信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../daily work/开发对照表.html">
            
                <a href="../daily work/开发对照表.html">
            
                    
                    开发对照表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.7" data-path="../daily work/微信推送.html">
            
                <a href="../daily work/微信推送.html">
            
                    
                    微信推送
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.8" data-path="../daily work/项目推送.html">
            
                <a href="../daily work/项目推送.html">
            
                    
                    项目推送
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    git
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../git/常用命令.html">
            
                <a href="../git/常用命令.html">
            
                    
                    常用命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../git/常见问题.html">
            
                <a href="../git/常见问题.html">
            
                    
                    常见问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../git/里程碑.html">
            
                <a href="../git/里程碑.html">
            
                    
                    里程碑
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" >
            
                <span>
            
                    
                    ionic
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../ionic/ionic.html">
            
                <a href="../ionic/ionic.html">
            
                    
                    ionic
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../ionic/开发问题.html">
            
                <a href="../ionic/开发问题.html">
            
                    
                    开发问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../ionic/技巧.html">
            
                <a href="../ionic/技巧.html">
            
                    
                    技巧
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" >
            
                <span>
            
                    
                    javascript
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../javascript/BroadcastChannel通信.html">
            
                <a href="../javascript/BroadcastChannel通信.html">
            
                    
                    BroadcastChannel通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../javascript/css文件转行内样式.html">
            
                <a href="../javascript/css文件转行内样式.html">
            
                    
                    css文件转行内样式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../javascript/DOM对象属性、鼠标事件.html">
            
                <a href="../javascript/DOM对象属性、鼠标事件.html">
            
                    
                    DOM对象属性、鼠标事件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../javascript/excel导出.html">
            
                <a href="../javascript/excel导出.html">
            
                    
                    excel导出
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../javascript/js写库方法.html">
            
                <a href="../javascript/js写库方法.html">
            
                    
                    js写库方法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../javascript/pdf文本获取.html">
            
                <a href="../javascript/pdf文本获取.html">
            
                    
                    pdf文本获取
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../javascript/webwork.html">
            
                <a href="../javascript/webwork.html">
            
                    
                    webwork
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="../javascript/前端实用方法和工具.html">
            
                <a href="../javascript/前端实用方法和工具.html">
            
                    
                    前端实用方法和工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="../javascript/浅拷贝与深拷贝.html">
            
                <a href="../javascript/浅拷贝与深拷贝.html">
            
                    
                    浅拷贝与深拷贝
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.10" data-path="../javascript/粘贴板.html">
            
                <a href="../javascript/粘贴板.html">
            
                    
                    粘贴板
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.11" data-path="../javascript/输入框输入控制.html">
            
                <a href="../javascript/输入框输入控制.html">
            
                    
                    输入框输入控制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.12" data-path="../javascript/页面渲染性能优化.html">
            
                <a href="../javascript/页面渲染性能优化.html">
            
                    
                    页面渲染性能优化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <span>
            
                    
                    js特效
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../js特效/特效.html">
            
                <a href="../js特效/特效.html">
            
                    
                    特效
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    mysql
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../mysql/mysql学习.html">
            
                <a href="../mysql/mysql学习.html">
            
                    
                    mysql学习
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    network
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../network/frp学习.html">
            
                <a href="../network/frp学习.html">
            
                    
                    frp学习
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" >
            
                <span>
            
                    
                    nginx
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../nginx/nginx学习.html">
            
                <a href="../nginx/nginx学习.html">
            
                    
                    nginx学习
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" >
            
                <span>
            
                    
                    node package manage
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../node package manage/npm.html">
            
                <a href="../node package manage/npm.html">
            
                    
                    npm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../node package manage/nvm.html">
            
                <a href="../node package manage/nvm.html">
            
                    
                    nvm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="../node package manage/pnpm.html">
            
                <a href="../node package manage/pnpm.html">
            
                    
                    pnpm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.4" data-path="../node package manage/其他.html">
            
                <a href="../node package manage/其他.html">
            
                    
                    其他
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.5" data-path="../node package manage/私有仓库部署.html">
            
                <a href="../node package manage/私有仓库部署.html">
            
                    
                    私有仓库部署
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.16" >
            
                <span>
            
                    
                    pda
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.16.1" data-path="../pda/broadcast广播.html">
            
                <a href="../pda/broadcast广播.html">
            
                    
                    broadcast广播
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.17" >
            
                <span>
            
                    
                    python
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.17.1" data-path="../python/python学习.html">
            
                <a href="../python/python学习.html">
            
                    
                    python学习
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.18" >
            
                <span>
            
                    
                    shared
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.18.1" data-path="git与svn.html">
            
                <a href="git与svn.html">
            
                    
                    git与svn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.2" data-path="handsontable.html">
            
                <a href="handsontable.html">
            
                    
                    handsontable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.3" data-path="IM即时通信.html">
            
                <a href="IM即时通信.html">
            
                    
                    IM即时通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.4" data-path="ng-alain.html">
            
                <a href="ng-alain.html">
            
                    
                    ng-alain
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.18.5" data-path="pdf预览、文本获取及处理.html">
            
                <a href="pdf预览、文本获取及处理.html">
            
                    
                    pdf预览、文本获取及处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.6" data-path="PicGO安装与配置SMMS图床.html">
            
                <a href="PicGO安装与配置SMMS图床.html">
            
                    
                    PicGO安装与配置SMMS图床
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.7" data-path="webcomponent及angular的变化检测机制.html">
            
                <a href="webcomponent及angular的变化检测机制.html">
            
                    
                    webcomponent及angular的变化检测机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.8" data-path="内嵌视图与宿主视图.html">
            
                <a href="内嵌视图与宿主视图.html">
            
                    
                    内嵌视图与宿主视图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.9" data-path="技术选型及代码规范.html">
            
                <a href="技术选型及代码规范.html">
            
                    
                    技术选型及代码规范
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.10" data-path="模块化 AMD、CommonJS、ES6.html">
            
                <a href="模块化 AMD、CommonJS、ES6.html">
            
                    
                    模块化 AMD、CommonJS、ES6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.11" data-path="生产排期性能分析.html">
            
                <a href="生产排期性能分析.html">
            
                    
                    生产排期性能分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.12" data-path="表格封装.html">
            
                <a href="表格封装.html">
            
                    
                    表格封装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18.13" data-path="项目建议及优化.html">
            
                <a href="项目建议及优化.html">
            
                    
                    项目建议及优化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.19" >
            
                <span>
            
                    
                    study-document
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.19.1" data-path="../study-document/rbac.html">
            
                <a href="../study-document/rbac.html">
            
                    
                    rbac
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.20" >
            
                <span>
            
                    
                    tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.20.1" data-path="../tools/css文件转行内样式.html">
            
                <a href="../tools/css文件转行内样式.html">
            
                    
                    css文件转行内样式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.2" data-path="../tools/typora.html">
            
                <a href="../tools/typora.html">
            
                    
                    typora
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.3" data-path="../tools/vscode.html">
            
                <a href="../tools/vscode.html">
            
                    
                    vscode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.4" data-path="../tools/xftp与xshell.html">
            
                <a href="../tools/xftp与xshell.html">
            
                    
                    xftp与xshell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.5" data-path="../tools/代码编辑器插件.html">
            
                <a href="../tools/代码编辑器插件.html">
            
                    
                    代码编辑器插件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.6" data-path="../tools/图床与图床工具.html">
            
                <a href="../tools/图床与图床工具.html">
            
                    
                    图床与图床工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.7" data-path="../tools/图片及性能优化.html">
            
                <a href="../tools/图片及性能优化.html">
            
                    
                    图片及性能优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.8" data-path="../tools/实用工具.html">
            
                <a href="../tools/实用工具.html">
            
                    
                    实用工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20.9" data-path="../tools/拖拽.html">
            
                <a href="../tools/拖拽.html">
            
                    
                    拖拽
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.21" >
            
                <span>
            
                    
                    typescript
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.21.1" data-path="../typescript/装饰器.html">
            
                <a href="../typescript/装饰器.html">
            
                    
                    装饰器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21.2" data-path="../typescript/进阶及高级用法.html">
            
                <a href="../typescript/进阶及高级用法.html">
            
                    
                    进阶及高级用法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.22" >
            
                <span>
            
                    
                    vite
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.22.1" data-path="../vite/angular集成vite测试.html">
            
                <a href="../vite/angular集成vite测试.html">
            
                    
                    angular集成vite测试
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.23" >
            
                <span>
            
                    
                    vue
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.23.1" data-path="../vue/devtools.html">
            
                <a href="../vue/devtools.html">
            
                    
                    devtools
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23.2" data-path="../vue/vue3.0.html">
            
                <a href="../vue/vue3.0.html">
            
                    
                    vue3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23.3" data-path="../vue/vue3.0开发事项.html">
            
                <a href="../vue/vue3.0开发事项.html">
            
                    
                    vue3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.23.4" data-path="../vue/vue细节处理.html">
            
                <a href="../vue/vue细节处理.html">
            
                    
                    vue细节处理
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.24" >
            
                <span>
            
                    
                    workflow
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.24.1" data-path="../workflow/drone.html">
            
                <a href="../workflow/drone.html">
            
                    
                    drone
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >pdf预览、文本获取及处理</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="pdf&#x9884;&#x89C8;&#x3001;&#x6587;&#x672C;&#x83B7;&#x53D6;&#x53CA;&#x5904;&#x7406;">PDF&#x9884;&#x89C8;&#x3001;&#x6587;&#x672C;&#x83B7;&#x53D6;&#x53CA;&#x5904;&#x7406;</h1>
<hr>
<p>github&#xFF1A;<a href="https://github.com/mozilla/pdf.js" target="_blank">GitHub - mozilla/pdf.js: PDF Reader in JavaScript</a></p>
<p>cdn&#x5730;&#x5740;&#xFF1A;<a href="https://cdnjs.com/libraries/pdf.js" target="_blank">https://cdnjs.com/libraries/pdf.js</a></p>
<p>&#x53C2;&#x8003;&#xFF1A;<a href="https://qa.1r1g.com/sf/ask/2844518561/" target="_blank">https://qa.1r1g.com/sf/ask/2844518561/</a></p>
<p>&#x6CE8;&#xFF1A;pdf&#x6587;&#x4EF6;&#x5FC5;&#x987B;&#x5B58;&#x653E;&#x5728;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x4E0D;&#x80FD;&#x83B7;&#x53D6;file://&#x534F;&#x8BAE;&#x6587;&#x4EF6;&#xFF0C;&#x4F1A;&#x63D0;&#x793A;&#x8DE8;&#x57DF;&#x3002;&#x9884;&#x89C8;&#x6587;&#x4EF6;&#x987B;&#x4EE5;https&#x5F00;&#x5934;&#x7684;&#x5B89;&#x5168;&#x57DF;&#x540D;&#x3002;</p>
<hr>
<h5 id="&#x9884;&#x89C8;">&#x9884;&#x89C8;</h5>
<p>pdf&#x6587;&#x4EF6;&#xFF1A;<a href="https://www.gjtool.cn/pdfh5/git.pdf" target="_blank">Git Tutorial (gjtool.cn)</a></p>
<p>github&#x7684;pdf-viewer&#xFF1A;<a href="https://mozilla.github.io/pdf.js/web/viewer.html" target="_blank">https://mozilla.github.io/pdf.js/web/viewer.html)</a></p>
<p>&#x4F7F;&#x7528;&#xFF1A;</p>
<p>pdf&#x8DEF;&#x5F84;&#x4F7F;&#x7528; encodeURIComponent &#x8FDB;&#x884C;&#x7F16;&#x7801;&#x3002;encodeURIComponent(&apos;<a href="https://www.gjtool.cn/pdfh5/git.pdf" target="_blank">https://www.gjtool.cn/pdfh5/git.pdf</a>&apos;)</p>
<p>&#x6700;&#x7EC8;&#x6548;&#x679C;&#xFF1A;<a href="https://mozilla.github.io/pdf.js/web/viewer.html?file=https%3A%2F%2Fwww.gjtool.cn%2Fpdfh5%2Fgit.pdf" target="_blank">https://mozilla.github.io/pdf.js/web/viewer.html?file=https%3A%2F%2Fwww.gjtool.cn%2Fpdfh5%2Fgit.pdf)</a></p>
<p><img src="http://markdown.rossai.cn/data/image/2022/09/19/74827_qiqp_7228.png" alt=""></p>
<hr>
<h5 id="&#x6587;&#x672C;&#x83B7;&#x53D6;">&#x6587;&#x672C;&#x83B7;&#x53D6;</h5>
<pre><code class="lang-js">&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/pdf.js/2.14.305/pdf.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/pdf.js/2.14.305/pdf.sandbox.min.js&quot;&gt;&lt;/script&gt;

const pdfUrl = &apos;https://www.gjtool.cn/pdfh5/git.pdf&apos;;

function getText(pdfUrl) {
  var loadingTask = pdfjsLib.getDocument(pdfUrl);
  return loadingTask.promise.then((pdf) =&gt; {
    // &#x83B7;&#x53D6;&#x9875;&#x6570;
    const pageNum = pdf._pdfInfo.numPages;
    const countPromises = [];
    for (let index = 1; index &lt;= pageNum; index++) {
      countPromises.push(pdf.getPage(index).then((res) =&gt; {
        // &#x83B7;&#x53D6;&#x6587;&#x672C;
        const data = res.getTextContent();
        return data.then((text) =&gt; {
          return text.items.map((item, i) =&gt; { return item.str; }).join(``);
        });
      }));
    }
    console.log(countPromises);
    return Promise.all(countPromises).then((res) =&gt; {
      return res.join(&apos;&apos;);
    });
  });
}

getText(pdfUrl).then((res) =&gt; {
  console.log(res);
}, (err) =&gt; {
  console.log(err);
});
</code></pre>
<p><img src="http://markdown.rossai.cn/data/image/2022/09/19/74984_yix3_2054.png" alt=""></p>
<hr>
<h5 id="&#x6570;&#x636E;&#x63D0;&#x53D6;&#x53CA;&#x5904;&#x7406;">&#x6570;&#x636E;&#x63D0;&#x53D6;&#x53CA;&#x5904;&#x7406;</h5>
<p>&#x9700;&#x5904;&#x7406;&#x7684;&#x6587;&#x4EF6;&#xFF1A;
<img src="http://markdown.rossai.cn/data/image/2022/09/19/76002_seum_6730.png" alt="">
<img src="http://markdown.rossai.cn/data/image/2022/09/19/76002_rdeo_4025.png" alt="">
<img src="http://markdown.rossai.cn/data/image/2022/09/19/76002_bkh7_4771.png" alt="">
<img src="http://markdown.rossai.cn/data/image/2022/09/19/76002_tde2_3597.png" alt="">
<img src="http://markdown.rossai.cn/data/image/2022/09/19/76003_eqoo_2390.png" alt="">
&#x5904;&#x7406;&#x65B9;&#x6CD5;&#xFF1A;</p>
<pre><code class="lang-js">import { HttpClient } from &apos;@angular/common/http&apos;;
import { Injectable, Injector } from &apos;@angular/core&apos;;
import { NzModalService } from &apos;ng-zorro-antd/modal&apos;;
import { GlobalWorkerOptions, getDocument } from &apos;pdfjs-dist&apos;;
import { PdfTmplListModalComponent } from &apos;../components/pdf/pdf-tmpl-list-modal/pdf-tmpl-list-modal.component&apos;;
import { CommonService } from &apos;./common.service&apos;;

export interface PdfOption {
  title?: string,
  privige?: {

  },
  type: &apos;PDF&apos;;
  pdfTmplList?: {
    desction: string;
    fileCount: number;
    fileList: string[];
    function: string,
    id: number;
    name: string;
    isUsed: boolean;
    [key: string]: any;
  }[],
  reflesh?: boolean
}

// pdf&#x670D;&#x52A1;

@Injectable({
  providedIn: &apos;root&apos;
})
export class PdfService {

  sectionSplitTag = &apos;&lt;section&gt;&apos;; // &#x533A;&#x57DF;&#x5206;&#x5272;&#x6807;&#x8BC6;
  contentSectionsplitTag = &apos;&lt;content&gt;&apos;; // &#x5185;&#x5BB9;&#x5206;&#x5757;&#x5206;&#x9694;&#x8868;&#x793A;
  contentSplitTag = &apos;|&apos;; // &#x5185;&#x5BB9;&#x5206;&#x5272;&#x6807;&#x8BC6;
  pageSplitTag = &apos;&lt;page&gt;&apos;; // &#x9875;&#x9762;&#x5206;&#x5272;&#x6807;&#x8BC6;

  constructor(
    private nzModalService: NzModalService,
    private http: HttpClient,
    private injector: Injector
  ) { }

  /** &#x83B7;&#x53D6;&#x6A21;&#x677F;&#x6570;&#x636E; */
  getPdf() {
    return new Promise((resolve, reject) =&gt; {
      this.http.get(`assets/pdf/pdf.json?t=${Date.now()}`).subscribe((res: object) =&gt; {
        resolve(res);
      });
    });
  }

  /** &#x5BFC;&#x5165;&#x5217;&#x8868; */
  getPdfImportList(params: object) {
    return this.injector.get(CommonService).httpGet({ url: &apos;/PdfImport/getPdfImportList&apos;, params });
  }

  /** &#x6DFB;&#x52A0;PDF&#x6570;&#x636E; */
  addPdfImport(fd: FormData) {
    return this.injector.get(CommonService).httpPost({ url: &apos;/PdfImport/addPdfImport&apos;, fd });
  }

  /** &#x7F16;&#x8F91;PDF&#x5BFC;&#x5165;&#x6570;&#x636E; */
  editPdfImportList(fd: FormData) {
    return this.injector.get(CommonService).httpPost({ url: &apos;/PdfImport/editPdfImportList&apos;, fd });
  }

  /** &#x4E0A;&#x4F20;&#x6587;&#x4EF6; */
  uploadFiles(fd: FormData) {
    return this.injector.get(CommonService).httpPost({ url: &apos;/base/uploadFiles&apos;, fd });
  }

  /** pdf&#x6A21;&#x6001;&#x6846; */
  pdfModal(obj?: PdfOption) {
    const modal = this.nzModalService.create({
      nzContent: PdfTmplListModalComponent,
      nzComponentParams:
      {
        obj,
        type: obj ? obj.type : &apos;PDF&apos;
      },
      nzWidth: &apos;1600px&apos;,
      nzFooter: null,
      nzCentered: true,
      nzMaskClosable: false,
      nzClosable: false
    });
    return modal;
  }

  /** &#x83B7;&#x53D6;pdf&#x6587;&#x672C;&#x4FE1;&#x606F; */
  getText(obj: {
    pdfUrl: string,
    sectionList?: string[], // &#x533A;&#x57DF;&#x6807;&#x8BC6;&#x6587;&#x5B57;
  }) {
    // &#x5FC5;&#x987B;&#x8BBE;&#x5B9A;work&#x5DE5;&#x4F5C;&#x533A;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x62A5;&#x9519;
    GlobalWorkerOptions.workerSrc = &apos;https://cdn.bootcdn.net/ajax/libs/pdf.js/2.14.305/pdf.worker.min.js&apos;;
    var loadingTask = getDocument(obj.pdfUrl);
    return loadingTask.promise.then((pdf) =&gt; {
      const pageNum = pdf._pdfInfo.numPages;
      const countPromises = [];
      for (let index = 1; index &lt;= pageNum; index++) {
        countPromises.push(pdf.getPage(index).then((res) =&gt; {
          const data = res.getTextContent();
          return data.then((text) =&gt; {
            // console.log(text);
            const reg = /(^\s+)|(\s+$)|\s+/g;
            return text.items
              .filter((item: any) =&gt; item.str !== &apos;&apos;)
              .map((item: any) =&gt; {
                const str = item.str;
                if ((obj.sectionList || []).some((i) =&gt; i.startsWith(str))) { // &#x533A;&#x57DF;&#x6807;&#x8BC6;
                  return `${this.sectionSplitTag}${str}[${item.transform[4]},${item.transform[5]},${item.width}]${this.contentSectionsplitTag}`;
                } else { // &#x5185;&#x5BB9;&#x6807;&#x8BC6;
                  if (str.trim() !== &apos;&apos;) { // &#x5185;&#x5BB9;&#x4E0D;&#x4E3A;&#x7A7A;&#x6DFB;&#x52A0;&#x6807;&#x8BC6;
                    return `${str}[${item.transform[4]},${item.transform[5]},${item.width}]${this.contentSplitTag}`;
                  } else {
                    return str;
                  }
                }
              }).join(&apos;&apos;);
          });
        }));
      }
      return Promise.all(countPromises).then((res) =&gt; {
        return res.join(this.pageSplitTag); // &#x9875;&#x9762;&#x5206;&#x5272;&#x6807;&#x8BC6;
      });
    }).catch((error) =&gt; {
      // &#x89E3;&#x6790;&#x5931;&#x8D25;
      throw new Error(error);
    });
  }

  /** &#x5220;&#x9664;&#x524D;&#x540E;&#x5206;&#x9694;&#x7B26; */
  delLRSplit(obj: { str: string }) {
    if (obj.str.startsWith(this.contentSplitTag)) {
      obj.str = obj.str.substring(1, obj.str.length);
    }
    if (obj.str.endsWith(this.contentSplitTag)) {
      obj.str = obj.str.substring(0, obj.str.length - 1);
    }
    return obj.str;
  }

  /** &#x5220;&#x9664;&#x6240;&#x6709;&#x5206;&#x9694;&#x7B26; */
  delAllSplit(obj: { str: string }) {
    if (this.sectionSplitTag) {
      obj.str = obj.str.replaceAll(this.sectionSplitTag, this.contentSplitTag);
    }
    if (this.contentSectionsplitTag) {
      obj.str = obj.str.replaceAll(this.contentSectionsplitTag, this.contentSplitTag);
    }
    if (this.pageSplitTag) {
      obj.str = obj.str.replaceAll(this.pageSplitTag, this.contentSplitTag);
    }
    return obj.str;
  }

  /** &#x6E05;&#x9664;&#x5750;&#x6807; */
  clearPosition(obj: { str: string }) {
    return obj.str.replaceAll(/\[.*?\]/g, &apos;&apos;);
  }

  /** &#x683C;&#x5F0F;&#x5316;&#x56DE;&#x6570;&#x7EC4;&#x5750;&#x6807; */
  positionReset(obj: { str: string }) {
    obj.str = this.delAllSplit({ str: obj.str });
    let list = this.delLRSplit({ str: obj.str })
      .split(this.contentSplitTag)
      .filter((item) =&gt; item !== &apos;&apos;)
      .map((item, i) =&gt; {
        let width = 0;
        let p = item.match(/\[.*?\]/g);
        let position = [-1, -1];
        if (p) {
          position = JSON.parse(p[0]);
          width = JSON.parse(p[0]) &amp;&amp; JSON.parse(p[0]).length &gt; 2 ? JSON.parse(p[0])[2] : 0;
        }
        const index = item.indexOf(&apos;[&apos;);
        if (index &gt; -1) {
          obj.str = item.substring(0, index);
        }
        return {
          str: obj.str,
          position,
          width
        }
      });
    return list;
  }

  /** &#x6E05;&#x9664;&#x9875;&#x5934; */
  clearPageHeader(obj: { str: string, reg: RegExp | string, replaceText?: string }) {
    obj.str = obj.str.replaceAll(obj.reg, obj.replaceText || &apos;&apos;);
    return obj.str;
  }

  /** &#x6E05;&#x9664;&#x9875;&#x811A; */
  clearPageFooter(obj: { str: string, reg: RegExp | string, replaceText?: string }) {
    obj.str = obj.str.replaceAll(obj.reg, obj.replaceText || &apos;&apos;);
    return obj.str;
  }

  /** &#x5750;&#x6807;&#x91CD;&#x6392;(&#x964D;&#x5E8F;) */
  // positionSort(obj: { str: string }) {
  //   // &#x6E05;&#x9664;&#x6240;&#x6709;&#x6807;&#x8BB0;
  //   obj.str = obj.str.replaceAll(this.sectionSplitTag, this.contentSplitTag);
  //   obj.str = obj.str.replaceAll(this.contentSectionsplitTag, this.contentSplitTag);
  //   let list = this.positionReset({ str: obj.str });
  //   // console.log(JSON.parse(JSON.stringify(list
  //   //   .sort((a, b) =&gt; {
  //   //     return b.position[1] - a.position[1];
  //   //   }))));
  //   list = list.sort((a, b) =&gt; {
  //     return b.position[1] - a.position[1];
  //   })
  //     .sort((a, b) =&gt; {
  //       return a.position[0] - b.position[0];
  //     })
  //   return obj.str;
  // }

  /** &#x6839;&#x636E;&#x5750;&#x6807;&#x8303;&#x56F4;&#x67E5;&#x627E;&#x5177;&#x4F53;&#x6570;&#x636E; */
  findInPosition(obj: { str: string, xStartPosition: number, xEndPosition: number, yStartPosition: number, yEndPosition: number }) {
    let list = this.positionReset({ str: obj.str });
    list = list.filter((item) =&gt;
      item.position[0] &gt;= obj.xStartPosition
      &amp;&amp; item.position[0] &lt;= obj.xEndPosition
      &amp;&amp; item.position[1] &gt;= obj.yStartPosition
      &amp;&amp; item.position[1] &lt;= obj.yEndPosition);
    return list;
  }

  /** &#x8FD4;&#x56DE;&#x6570;&#x7EC4;(&#x6709;&#x5E8F;&#x3001;&#x65E0;&#x5E8F;&#x5217;&#x8868;&#x548C;&#x8868;&#x683C;&#x5904;&#x7406;&#x540C;&#x4E00;&#x5355;&#x5143;&#x683C;&#x591A;&#x884C;&#x4FE1;&#x606F;)&#x3002;&#x884C;&#x5750;&#x6807;&#x76F8;&#x90BB;&#x8282;&#x70B9;&#x5408;&#x5E76;&#xFF0C;&#x4EE5;&#x7B2C;&#x4E00;&#x4E2A;&#x76F8;&#x90BB;&#x7684;&#x5217;&#x6570;&#x4E3A;&#x51C6;&#xFF0C;xSiblingDiff&#xFF1A;&#x76F8;&#x90BB;&#x5DEE;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;5 */
  xSiblingHandle(obj: { str: string, xSiblingDiff?: number }) {
    // &#x62BD;&#x53D6;&#x4F4D;&#x7F6E;&#x5E76;&#x8BA1;&#x7B97;&#x5408;&#x5E76;
    let list = this.positionReset({ str: obj.str });
    const result = [];
    list.forEach((item, index) =&gt; {
      if (index === 0) {
        result.push(item);
      } else {
        // &#x76F8;&#x90BB;&#x6570;&#x7EC4;&#x957F;&#x5EA6;&#x5927;&#x4E8E;2&#x624D;&#x9700;&#x8981;&#x5206;&#x5F00;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x88AB;&#x62FC;&#x63A5;&#x5728;&#x4E00;&#x8D77;
        if (list.length &gt; 2 &amp;&amp; Math.abs(list[index].position[0] - result[result.length - 1].position[0]) &lt; (obj.xSiblingDiff &amp;&amp; obj.xSiblingDiff &gt; 0 ? obj.xSiblingDiff : 5)) {
          result[result.length - 1].str = result[result.length - 1].str + list[index].str;
        } else {
          result.push(item);
        }
      }
    });
    return result.map((item) =&gt; {
      return {
        ...item,
        str: item.str.trim()
      }
    });
  }

  /** &#x6709;&#x5E8F;&#x8868;&#x683C;&#x6570;&#x636E;&#x5904;&#x7406;&#xFF08;&#x5C5E;&#x6027;&#x5728;&#x8868;&#x5934;&#xFF09;ySiblingDiff&#xFF1A;&#x5782;&#x76F4;&#x5DEE;&#x503C;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;5 */
  olTableHandle(obj: { str: string, col: number, xSiblingDiff?: number, ySiblingDiff?: number }) {
    const result = this.xSiblingHandle({ str: obj.str, xSiblingDiff: obj.xSiblingDiff });
    const list = [];
    // &#x521D;&#x59CB;&#x5316;&#x8868;&#x683C;&#x6570;&#x636E;
    let row = 0;
    let position = 0;
    result.forEach((item, index) =&gt; {
      if (index &gt;= obj.col) {
        if (index === obj.col) {
          position = item.position[1];
          row = 1;
        }
        if (item.position[1] !== -1 &amp;&amp; Math.abs(item.position[1] - position) &gt; (obj.ySiblingDiff &amp;&amp; obj.ySiblingDiff &gt; 0 ? obj.ySiblingDiff : 5)) {
          position = item.position[1];
          row += 1;
        }
      } else {
        list[row] = list[row] ? list[row] : [];
        list[row].push(item);
      }
    });
    // &#x7EC4;&#x88C5;&#x8868;&#x683C;&#x6570;&#x636E;
    for (let index = 1; index &lt;= row; index++) {
      list[0].forEach((item: any) =&gt; {
        list[index] = list[index] ? list[index] : [];
        list[index].push({
          str: &apos;&apos;,
          position: [-1, -1],
          width: 0
        });
      })
    }
    row = 0;
    result.forEach((item, index) =&gt; {
      if (index &gt;= obj.col) {
        if (index === obj.col) {
          position = item.position[1];
          row = 1;
        }
        if (item.position[1] !== -1 &amp;&amp; Math.abs(item.position[1] - position) &gt; (obj.ySiblingDiff &amp;&amp; obj.ySiblingDiff &gt; 0 ? obj.ySiblingDiff : 5)) {
          position = item.position[1];
          row += 1;
        }
        // &#x521D;&#x59CB;&#x7B97;&#x6CD5;
        // const i = list[0].findIndex((item2) =&gt; Math.abs(item2.position[0] - item.position[0]) &lt; (obj.ySiblingDiff &amp;&amp; obj.ySiblingDiff &gt; 0 ? obj.ySiblingDiff : 5));
        // if (i &gt; -1) {
        //   list[row][i] = item;
        // }
        // &#x7B97;&#x6CD5;&#x5347;&#x7EA7;&#xFF0C;&#x53D6;&#x533A;&#x95F4;&#x5185;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x62FC;&#x63A5;&#xFF0C;&#x4E0D;&#x9002;&#x7528;&#x4E8E;&#x8868;&#x5934;&#x5C5E;&#x6027;&#x6587;&#x5B57;&#x5C45;&#x4E2D;&#x6216;&#x8868;&#x5934;&#x5206;&#x7EC4;&#xFF0C;&#x56E0;&#x4E3A;&#x533A;&#x95F4;&#x8303;&#x56F4;&#x65E0;&#x6CD5;&#x8BA1;&#x7B97;
        const spaceList = list[0].map((item2) =&gt; item2.position[0]);
        spaceList.forEach((item2, index2) =&gt; {
          if (index2 !== (spaceList.length - 1) &amp;&amp; spaceList[index2] &lt;= item.position[0] &amp;&amp; spaceList[index2 + 1] &gt; item.position[0] || index2 === (spaceList.length - 1) &amp;&amp; spaceList[index2] &lt;= item.position[0]) {
            list[row][index2] = {
              ...item,
              str: list[row][index2].str + item.str
            };
          }
        })
        // &#x7B97;&#x6CD5;&#x5347;&#x7EA7;2&#xFF0C;&#x6839;&#x636E;&#x533A;&#x95F4;&#x4EA4;&#x96C6;&#x5224;&#x65AD;&#x6570;&#x636E;&#x662F;&#x5426;&#x5904;&#x4E8E;&#x540C;&#x4E00;&#x4E2A;&#x5355;&#x5143;&#x683C;&#xFF0C;&#x4E0D;&#x9002;&#x7528;&#x4E8E;&#x8868;&#x5934;&#x5C5E;&#x6027;&#x6587;&#x5B57;&#x5C45;&#x4E2D;&#x6216;&#x8868;&#x5934;&#x5206;&#x7EC4;&#xFF0C;&#x9664;&#x975E;&#x8868;&#x5934;&#x5C5E;&#x6027;&#x4E0E;&#x5185;&#x5BB9;&#x5BF9;&#x9F50;&#x65B9;&#x5F0F;&#x4E00;&#x81F4;&#xFF0C;&#x5426;&#x5219;&#x533A;&#x95F4;&#x8303;&#x56F4;&#x65E0;&#x6CD5;&#x8BA1;&#x7B97;
        // const spaceList1 = [item.position[0], item.position[0] + item.position[2]];
        // const spaceList2 = list[0].map((item2) =&gt; [item2.position[0], item2.position[0] + item2.position[2]]);
        // console.log(spaceList1, spaceList2);
        // spaceList2.forEach((item2, index2) =&gt; {
        //   let start = [Math.min(...spaceList1), Math.min(...item2)]; //&#x533A;&#x95F4;&#x7684;&#x4E24;&#x4E2A;&#x6700;&#x5C0F;&#x503C;
        //   let end = [Math.max(...spaceList1), Math.max(...item2)]; //&#x533A;&#x95F4;&#x7684;&#x4E24;&#x4E2A;&#x6700;&#x5927;&#x503C;
        //   if (Math.max(...start) &lt;= Math.min(...end)) {
        //     list[row][index2] = {
        //       ...item,
        //       str: list[row][index2].str + item.str
        //     };
        //   }
        // })
      }
    });
    return list.map((item) =&gt; {
      return item.map((item2) =&gt; {
        return item2.str;
      })
    });
  }

  /** &#x65E0;&#x5E8F;&#x8868;&#x683C;&#x6570;&#x636E;&#x5904;&#x7406;&#xFF08;&#x5C5E;&#x6027;&#x5728;&#x5DE6;&#x4FA7;&#xFF09; */
  ulTableHandle(obj: { str: string }) {
    const list = [];
    let row = -1;
    obj.str.split(this.contentSplitTag).forEach((item, index) =&gt; {
      if (index % 2 === 0 &amp;&amp; item.trim()) {
        row += 1;
        list[row] = list[row] ? list[row] : [];
      }
      if (index % 2 === 0 &amp;&amp; item.trim() || index % 2 === 1 &amp;&amp; list[row].length &gt; 0) {
        list[row].push(this.clearPosition({ str: item }).trim());
      }
    })
    return list;
  }

  /** &#x6709;&#x5E8F;&#x5217;&#x8868;&#x6570;&#x636E;&#x5904;&#x7406; */
  olListHandle(obj: { str: string, keyList: string[] }) {
    const list = [];
    let row = -1;
    obj.str.split(this.contentSplitTag).forEach((item, index) =&gt; {
      if (index % obj.keyList.length === 0) {
        row += 1;
      }
      list[row] = list[row] ? list[row] : [];
      list[row].push(this.clearPosition({ str: item }).trim());
    })
    return list;
  }

  /** oncekeyList &#x53EA;&#x5BFB;&#x627E;&#x9996;&#x6B21;&#x51FA;&#x73B0;&#x7684;section&#x4F5C;&#x4E3A;&#x6807;&#x9898; */
  sectionHandle(obj: { list: string[], oncekeyList: string[] }) {
    obj.oncekeyList.forEach((item) =&gt; {
      const arr = obj.list.filter((item2) =&gt; item2.startsWith(item));
      if (arr.length &gt; 1) {
        arr.shift();
        arr.forEach((item2) =&gt; {
          const index3 = obj.list.findIndex((item3) =&gt; item3 === item2);
          if (index3 &gt; -1) {
            obj.list[index3] = obj.list[index3].replace(this.contentSectionsplitTag, this.contentSplitTag); // &#x5904;&#x7406;&#x975E;section&#x540E;&#x9762;&#x7B2C;&#x4E00;&#x4E2A;&#x5206;&#x5272;&#x7B26;
            obj.list[index3 - 1] = obj.list[index3 - 1] + obj.list[index3];
            obj.list.splice(index3, 1);
          }
        });
      }
    });
    return obj.list;
  }
}
</code></pre>
<hr>
<h5 id="&#x6700;&#x7EC8;&#x6570;&#x636E;&#x5904;&#x7406;">&#x6700;&#x7EC8;&#x6570;&#x636E;&#x5904;&#x7406;</h5>
<pre><code class="lang-js">import { Injectable, Injector } from &apos;@angular/core&apos;;
import moment from &apos;moment&apos;;
import { PdfService } from &apos;src/app/shared/services/pdf.service&apos;;

@Injectable({
  providedIn: &apos;root&apos;
})
export class HmService {

  orderNoCollectList = [];
  productNoCollectList = [];
  productName = &apos;&apos;; // &#x4EA7;&#x54C1;&#x540D;&#x79F0;
  seasonCollectList = []; // &#x91C7;&#x8D2D;&#x5355;&#x5B63;&#x8282;
  optionCollectList = []; // &#x4FE1;&#x606F;&#x8868;&#x7684;option&#x5206;&#x7EC4;
  noOfPieces = &apos;&apos;; // &#x6BCF;&#x5361;&#x652F;&#x6570;
  miscellaneousStr = &apos;&apos;; // &#x5305;&#x6750;&#x4FE1;&#x606F;
  compositionCollectList = []; // &#x4FE1;&#x606F;&#x8868;&#x7684;&#x6210;&#x5206;
  colorNameCollectList = []; // &#x989C;&#x8272;&#x540D;&#x79F0;&#x4FE1;&#x606F;
  invoiceAveragePriceCollectList = []; // &#x5E73;&#x5747;&#x5355;&#x4EF7;&#x3001;&#x8D70;&#x8D27;&#x65B9;&#x5F0F;
  termsDeliveryCollectList = []; // &#x8D70;&#x8D27;&#x65B9;&#x5F0F;&#x8BE6;&#x60C5;
  colorCollectList = []; // &#x4E09;&#x7EF4;&#x8868;&#x5BF9;&#x5E94;&#x7684;&#x989C;&#x8272;&#x7EC4;
  colorTableCollectList = []; // &#x4E09;&#x7EF4;&#x8868;&#xFF08;&#x989C;&#x8272;&#x3001;&#x8D70;&#x8D27;&#x65B9;&#x5F0F;&#x3001;&#x6570;&#x91CF;&#xFF09;
  timeDeliveryCollectList = [];
  sizePerColourBreakdownResultList = []; // SizePerColourBreakdown&#x7684;&#x7ED3;&#x679C;&#x96C6;&#xFF08;Article No&#x3001;H&amp;M Colour Code&#x3001;Option No&#x3001;Quantity&#xFF09;

  constructor(
    private injector: Injector
  ) { }

  get pdfService() {
    return this.injector.get(PdfService);
  }

  /** Supplementary Product Information.PDF */
  handle1(res: string) {
    res = this.pdfService.clearPageHeader({ str: res, reg: /HLW\s\S+-\S+\s\S+\s\S+\s-\s\d+-\d+.*?\]\|{0,1}/g });
    res = this.pdfService.clearPageFooter({ str: res, reg: /(Created).*?(?=Page)/g });
    res = this.pdfService.clearPageFooter({ str: res, reg: /(Page).*?\]\|{0,1}/g });

    res = res.split(this.pdfService.pageSplitTag).join(this.pdfService.contentSplitTag);

    // Order NO
    const orderNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 220,
      xEndPosition: 230,
      yStartPosition: 530,
      yEndPosition: 540,
    });
    const orderNoValue = orderNoResultList.length &gt; 0 ? orderNoResultList[0].str.trim() : &apos;&apos;;
    this.orderNoCollectList.push(orderNoValue);
    console.log(orderNoValue);

    // Product No
    const productNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 625,
      xEndPosition: 635,
      yStartPosition: 535,
      yEndPosition: 545,
    });
    const productNoValue = productNoResultList.length &gt; 0 ? productNoResultList[0].str.trim() : &apos;&apos;;
    this.productNoCollectList.push(productNoValue);
    console.log(productNoValue);

    // Product Name
    const productNameResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 625,
      xEndPosition: 635,
      yStartPosition: 520,
      yEndPosition: 530,
    });
    const productNameValue = productNameResultList.length &gt; 0 ? productNameResultList[0].str.trim() : &apos;&apos;;
    console.log(productNameValue);
    this.productName = productNameValue;

    // Option
    const optionResultList = (res.match(new RegExp(&apos;(?&lt;=Option:)((?!Remarks).)*&apos;, &apos;g&apos;)) || [])
      .map((item) =&gt; {
        return this.pdfService.clearPosition({ str: item.replaceAll(this.pdfService.contentSplitTag, &apos;&apos;) }).trim();
      });
    console.log(optionResultList);
    this.optionCollectList = optionResultList;

    // Composition
    const compositionList = (res.match(new RegExp(&apos;(?&lt;=Bill of Material: Materials and Trims)((?!Bill of Material: Production Units and Processing Capabilities).)*&apos;, &apos;g&apos;)) || [])
      .map((item) =&gt; {
        const tableList = this.pdfService.olTableHandle({ str: item, col: 13 });
        if (tableList.length &gt; 0) {
          const i = tableList[0].findIndex((item2) =&gt; item2.indexOf(&apos;Composition&apos;) &gt; -1);
          tableList.shift();
          return i &gt; -1 ? tableList.map((item2) =&gt; item2[i]) : [];
        } else {
          return [];
        }
      });
    console.log(compositionList);
    this.compositionCollectList = compositionList;

    // Colour Name
    const colorNameTableRegList = (res.match(new RegExp(`((?&lt;=Development Appearance).*(?=Option:))|((?&lt;=Development Appearance).*(?=Miscellaneous))`, &apos;g&apos;)) || []).map((item) =&gt; {
      let list = item.split(this.pdfService.contentSplitTag);
      list.splice(0, 1);
      return this.pdfService.delLRSplit({ str: list.join(this.pdfService.contentSplitTag) });
    });
    let colorNameList = [];
    colorNameTableRegList.forEach((item) =&gt; {
      let list = this.pdfService.olTableHandle({ str: item, col: 11 });
      list.splice(0, 1);
      colorNameList = colorNameList.concat(list);
    });
    console.log(colorNameList);
    this.colorNameCollectList = colorNameList;

    // Miscellaneous
    const miscellaneousRegList = (res.match(new RegExp(&apos;(?&lt;=Labels.*?\]).*&apos;, &apos;g&apos;)) || []);
    const miscellaneousList = miscellaneousRegList.length &gt; 0 ? this.pdfService.olTableHandle({ str: miscellaneousRegList[0], col: 6 }) : [];
    miscellaneousList.length &gt; 0 &amp;&amp; miscellaneousList.shift();
    const miscellaneous = miscellaneousList.map((item) =&gt; {
      return item[0];
    }).join(&apos;,&apos;);
    console.log(miscellaneous);
    this.miscellaneousStr = miscellaneous;
  }

  /** PurchaseOrder.PDF */
  handle2(res: string) {
    // Order NO
    let orderNoValue = &apos;&apos;;
    const orderNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 95,
      xEndPosition: 105,
      yStartPosition: 755,
      yEndPosition: 765,
    });
    if ([...new Set(orderNoResultList.map((item) =&gt; item.str))].length !== 1) {
      throw new Error(&apos;Order NO&#x4E0D;&#x4E00;&#x81F4;&apos;);
      return;
    } else {
      orderNoValue = orderNoResultList.length &gt; 0 ? orderNoResultList[0].str : &apos;&apos;;
    }
    this.orderNoCollectList.push(orderNoValue);
    console.log(orderNoValue);

    // Product No
    let productNoValue = &apos;&apos;;
    const productNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 335,
      xEndPosition: 345,
      yStartPosition: 755,
      yEndPosition: 765,
    });
    if ([...new Set(productNoResultList.map((item) =&gt; item.str))].length !== 1) {
      throw new Error(&apos;Product No&#x4E0D;&#x4E00;&#x81F4;&apos;);
      return;
    } else {
      productNoValue = productNoResultList.length &gt; 0 ? productNoResultList[0].str : &apos;&apos;;
    }
    this.productNoCollectList.push(productNoValue);
    console.log(productNoValue);

    // Season
    const seasonResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 335,
      xEndPosition: 345,
      yStartPosition: 715,
      yEndPosition: 725,
    }).map((item) =&gt; (item.str));
    console.log(seasonResultList);
    this.seasonCollectList = seasonResultList;

    // No of Pieces
    const noOfPiecesResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 335,
      xEndPosition: 345,
      yStartPosition: 640,
      yEndPosition: 650,
    }).map((item) =&gt; (item.str.trim()));
    console.log(noOfPiecesResultList);
    this.noOfPieces = noOfPiecesResultList.length &gt; 0 ? noOfPiecesResultList[0] : &apos;&apos;;

    // Terms of Delivery
    const termsDeliveryResultList = (res.match(new RegExp(&apos;(?&lt;=Terms of Delivery)((?!Country of Production).)*&apos;, &apos;g&apos;)) || [])
      .map((item) =&gt; {
        return this.pdfService.delLRSplit({ str: this.pdfService.clearPosition({ str: item }) }).split(this.pdfService.contentSplitTag);
      });
    console.log(termsDeliveryResultList);
    this.termsDeliveryCollectList = termsDeliveryResultList.length &gt; 0 ? termsDeliveryResultList[0] : [];

    // Time of Delivery
    let timeDeliveryResultList = [];
    const timeDeliveryRegList = (res.match(new RegExp(&apos;Time of Delivery((?!Terms of Delivery).)*&apos;, &apos;g&apos;)) || []);
    if (timeDeliveryRegList.length &gt; 0) {
      timeDeliveryResultList = this.pdfService.olTableHandle({ str: timeDeliveryRegList[0], col: 4 });
      timeDeliveryResultList.pop();
    }
    this.timeDeliveryCollectList = timeDeliveryResultList;
    console.log(timeDeliveryResultList);

    // Invoice Average Price
    const invoiceAveragePriceResultList = (res.match(new RegExp(&apos;Invoice Average Price((?!By accepting and performing under this Order).)*&apos;, &apos;g&apos;)) || [])
      .map((item) =&gt; {
        return this.pdfService.olTableHandle({ str: item, col: 2 });
      });
    console.log(invoiceAveragePriceResultList);
    this.invoiceAveragePriceCollectList = invoiceAveragePriceResultList;
  }

  /** SizePerColourBreakdown.PDF */
  handle3(res: string) {
    res = this.pdfService.clearPageHeader({ str: res, reg: /(Page).*?(?=Created)/g, replaceText: this.pdfService.sectionSplitTag });
    res = this.pdfService.clearPageFooter({ str: res, reg: /(Created).*?(?=Telephone)/g, replaceText: this.pdfService.sectionSplitTag });

    // Order NO
    let orderNoValue = &apos;&apos;;
    const orderNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 95,
      xEndPosition: 105,
      yStartPosition: 760,
      yEndPosition: 770,
    });
    if ([...new Set(orderNoResultList.map((item) =&gt; item.str))].length !== 1) {
      throw new Error(&apos;Order NO&#x4E0D;&#x4E00;&#x81F4;&apos;);
      return;
    } else {
      orderNoValue = orderNoResultList.length &gt; 0 ? orderNoResultList[0].str : &apos;&apos;;
    }
    this.orderNoCollectList.push(orderNoValue);
    console.log(orderNoValue);

    // Product No
    let productNoValue = &apos;&apos;;
    const productNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 320,
      xEndPosition: 330,
      yStartPosition: 760,
      yEndPosition: 770,
    });
    if ([...new Set(productNoResultList.map((item) =&gt; item.str))].length !== 1) {
      throw new Error(&apos;Product No&#x4E0D;&#x4E00;&#x81F4;&apos;);
      return;
    } else {
      productNoValue = productNoResultList.length &gt; 0 ? productNoResultList[0].str : &apos;&apos;;
    }
    this.productNoCollectList.push(productNoValue);
    console.log(productNoValue);

    // Colour / Country Breakdown
    const colorCountryBreakdownRegList = res.match(/^((?!Colour \/ Country Breakdown).)*/g) || [];
    const colorCountryBreakRegStr = colorCountryBreakdownRegList.length &gt; 0 ? colorCountryBreakdownRegList[0] : &apos;&apos;;
    const colorTableRegList = colorCountryBreakRegStr.match(/(?=Article:).*(?=Total)/g) || [];
    const colorTableRegStr = colorTableRegList.length &gt; 0 ? colorTableRegList[0] : &apos;&apos;;
    const colorRegList = colorTableRegStr.match(/(?&lt;=Article:)(.*?\|)(.*?(?=\|))/g) || [];
    const colorList = colorRegList.map((item) =&gt; {
      return this.pdfService.clearPosition({ str: item })
        .split(this.pdfService.contentSplitTag)
        .map((item2) =&gt; item2.trim());
    });
    console.log(colorList)
    this.colorCollectList = colorList;
    // &#x8868;&#x683C;&#x5185;&#x5BB9;&#x6570;&#x636E;
    const colorRegList2 = colorTableRegStr.match(/Article:(.*?\|)(.*?\|)/g) || [];
    let tableStr = colorTableRegStr;
    colorRegList2.forEach((item) =&gt; {
      tableStr = tableStr.replace(item, &apos;&apos;);
    });
    const tableList = this.pdfService.olTableHandle({ str: this.pdfService.delLRSplit({ str: tableStr }), col: 3 + colorList.length });
    console.log(tableList);
    this.colorTableCollectList = tableList;
  }

  /** TotalCountryBreakdown.PDF */
  handle4(res: string) {
    res = this.pdfService.clearPageHeader({ str: res, reg: /(Page).*?(?=Created)/g, replaceText: this.pdfService.sectionSplitTag });
    res = this.pdfService.clearPageFooter({ str: res, reg: /(Created).*?(?=Telephone)/g, replaceText: this.pdfService.sectionSplitTag });

    const pageList = res.split(this.pdfService.pageSplitTag);

    // Order NO
    let orderNoValue = &apos;&apos;;
    const orderNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 95,
      xEndPosition: 105,
      yStartPosition: 760,
      yEndPosition: 770,
    });
    if ([...new Set(orderNoResultList.map((item) =&gt; item.str))].length !== 1) {
      throw new Error(&apos;Order NO&#x4E0D;&#x4E00;&#x81F4;&apos;);
      return;
    } else {
      orderNoValue = orderNoResultList.length &gt; 0 ? orderNoResultList[0].str : &apos;&apos;;
    }
    this.orderNoCollectList.push(orderNoValue);
    console.log(orderNoValue);

    // Product No
    let productNoValue = &apos;&apos;;
    const productNoResultList = this.pdfService.findInPosition({
      str: res,
      xStartPosition: 320,
      xEndPosition: 330,
      yStartPosition: 760,
      yEndPosition: 770,
    });
    if ([...new Set(productNoResultList.map((item) =&gt; item.str))].length !== 1) {
      throw new Error(&apos;Product No&#x4E0D;&#x4E00;&#x81F4;&apos;);
      return;
    } else {
      productNoValue = productNoResultList.length &gt; 0 ? productNoResultList[0].str : &apos;&apos;;
    }
    this.productNoCollectList.push(productNoValue);
    console.log(productNoValue);


    const countryReg = `(?&lt;=\\* Sizes in brackets indicate general European sizes.*?\\${this.pdfService.contentSplitTag}).*(?=\\${this.pdfService.contentSplitTag}Size / Colour breakdown)`;
    const articleNoReg = `(?&lt;=Article No.*?\\${this.pdfService.contentSplitTag}).*(?=\\${this.pdfService.contentSplitTag}H&amp;M Colour Code)`;
    const HMColourCodeReg = `(?&lt;=H&amp;M Colour Code.*?\\${this.pdfService.contentSplitTag}).*(?=\\${this.pdfService.contentSplitTag}Colour Name)`;
    const optionNoReg = `(?&lt;=Option No.*?\\${this.pdfService.contentSplitTag}).*(?=\\${this.pdfService.contentSplitTag}\\* Sizes in brackets indicate general European sizes)`;
    const quantityReg = `(?&lt;=Quantity.*?\\${this.pdfService.contentSplitTag}).*(?=\\${this.pdfService.contentSplitTag}No of Asst)`;
    const resultList = [];
    pageList.forEach((item) =&gt; {
      const country = item.match(new RegExp(countryReg)) &amp;&amp; item.match(new RegExp(countryReg))[0] || &apos;&apos;;
      const articleNo = item.match(new RegExp(articleNoReg)) &amp;&amp; item.match(new RegExp(articleNoReg))[0] || &apos;&apos;;
      const HMColourCode = item.match(new RegExp(HMColourCodeReg)) &amp;&amp; item.match(new RegExp(HMColourCodeReg))[0] || &apos;&apos;;
      const optionNo = item.match(new RegExp(optionNoReg)) &amp;&amp; item.match(new RegExp(optionNoReg))[0] || &apos;&apos;;
      const quantity = item.match(new RegExp(quantityReg)) &amp;&amp; item.match(new RegExp(quantityReg))[0] || &apos;&apos;;
      const list = [];
      if (country) {
        list.push(this.pdfService.clearPosition({ str: country }));
      }
      if (articleNo) {
        list.push(
          this.pdfService.clearPosition({ str: articleNo })
            .split(this.pdfService.contentSplitTag)
            .map((item2) =&gt; (item2.trim()))
        );
      } else {
        list.push([])
      }
      if (HMColourCode) {
        list.push(
          this.pdfService.clearPosition({ str: HMColourCode })
            .split(this.pdfService.contentSplitTag)
            .map((item2) =&gt; (item2.trim()))
        );
      } else {
        list.push([])
      }
      if (optionNo) {
        list.push(
          this.pdfService.clearPosition({ str: optionNo })
            .split(this.pdfService.contentSplitTag)
            .map((item2) =&gt; (item2.trim()))
        );
      } else {
        list.push([])
      }
      if (quantity) {
        list.push(
          this.pdfService.clearPosition({ str: quantity })
            .split(this.pdfService.contentSplitTag)
            .map((item2) =&gt; (item2.trim()))
        );
      } else {
        list.push([])
      }
      resultList.push(list);
    });
    this.sizePerColourBreakdownResultList = resultList;
    console.log(resultList);
  }

  mergeHandle(obj: {
    pdfUrl1: string,
    sectionList1?: string[],
    pdfUrl2: string,
    sectionList2?: string[],
    pdfUrl3: string,
    sectionList3?: string[],
    pdfUrl4: string,
    sectionList4?: string[]
  }) {
    return Promise.all([
      // this.pdfService.getText({ pdfUrl: &apos;http://localhost:4200/assets/pdf/hm/Supplementary Product Information.pdf&apos;, sectionList: obj.sectionList1 }),
      // this.pdfService.getText({ pdfUrl: &apos;http://localhost:4200/assets/pdf/hm/PurchaseOrder.PDF&apos;, sectionList: obj.sectionList2 }),
      // this.pdfService.getText({ pdfUrl: &apos;http://localhost:4200/assets/pdf/hm/TotalCountryBreakdown.PDF&apos;, sectionList: obj.sectionList3 }),
      // this.pdfService.getText({ pdfUrl: &apos;http://localhost:4200/assets/pdf/hm/SizePerColourBreakdown.PDF&apos;, sectionList: obj.sectionList4 })
      this.pdfService.getText({ pdfUrl: obj.pdfUrl1, sectionList: obj.sectionList1 }),
      this.pdfService.getText({ pdfUrl: obj.pdfUrl2, sectionList: obj.sectionList2 }),
      this.pdfService.getText({ pdfUrl: obj.pdfUrl3, sectionList: obj.sectionList3 }),
      this.pdfService.getText({ pdfUrl: obj.pdfUrl4, sectionList: obj.sectionList4 })
    ]).then((res) =&gt; {
      // &#x6570;&#x636E;&#x5904;&#x7406;&#x53CA;&#x6821;&#x9A8C;
      res.forEach((item, index) =&gt; {
        switch (index + 1) {
          case 1: this.handle1(item); break;
          case 2: this.handle2(item); break;
          case 3: this.handle3(item); break;
          case 4: this.handle4(item); break;
        }
        console.log(&apos;----------------------------&apos;);
      })

      let orderNo = &apos;&apos;;
      let productNo = &apos;&apos;;
      let orderNoList = [...new Set(this.orderNoCollectList)];
      let productNoList = [...new Set(this.productNoCollectList)];
      if (orderNoList.length !== 1) {
        throw new Error(&apos;Order No&#x4E0D;&#x4E00;&#x81F4;&apos;);
      }
      orderNo = orderNoList[0];
      if (productNoList.length !== 1) {
        throw new Error(&apos;Product No&#x4E0D;&#x4E00;&#x81F4;&apos;);
      }
      productNo = productNoList[0];

      console.log(&apos;&#x6570;&#x636E;&#x7EC4;&#x88C5;------------------&apos;);
      const colorList = this.colorCollectList.map((item) =&gt; {
        return {
          colorNo: item.length &gt; 1 ? item[1] : &apos;&apos;
        }
      })
      let resultList = [];
      this.sizePerColourBreakdownResultList.forEach((item1, index1) =&gt; {
        if (item1[0]) {
          item1[1].forEach((item2, index2) =&gt; {
            const planningMarkets = item1[0].match(/(?&lt;=\s{1})\S+\s{1}\(\S+\)/g) ? item1[0].match(/(?&lt;=\s{1})\S+\s{1}\(\S+\)/g)[0] : &apos;&apos;
            // &#x989C;&#x8272;&#x540D;&#x79F0;&#x5339;&#x914D;
            const colorNameIndex = this.colorNameCollectList.findIndex((item3) =&gt; item3.length &gt; 3 &amp;&amp; item3[1] === item1[2][index2]);

            // &#x6570;&#x91CF;&#x5339;&#x914D;
            const country = planningMarkets.match(/(?&lt;=\().*(?=\))/g) ? planningMarkets.match(/(?&lt;=\().*(?=\))/g)[0] : &apos;&apos;;
            const countryIndex = this.colorTableCollectList.map((item3) =&gt; (item3[1])).findIndex((item3) =&gt; item3.indexOf(country) &gt; -1);
            const colorIndex = colorList.findIndex((item3) =&gt; item3.colorNo === item1[2][index2]);

            // &#x8D70;&#x8D27;&#x65B9;&#x5F0F;&#x8BE6;&#x60C5;
            const countryShort = planningMarkets.match(/.+(?=\s\()/g) ? planningMarkets.match(/.+(?=\s\()/g)[0] : &apos;&apos;;
            const trimsOfDelivery = this.termsDeliveryCollectList.filter((item3, index3) =&gt; index3 % 2 === 0).join(&apos;,&apos;);

            resultList.push({
              SoId: &apos;&apos;,
              MatId: &apos;&apos;,
              orderNo, // &#x5BA2;&#x6237;&#x8BA2;&#x5355;&#x53F7;
              productNo, // &#x5BA2;&#x6237;&#x4EA7;&#x54C1;&#x7F16;&#x53F7;
              productName: this.productName, // &#x4EA7;&#x54C1;&#x540D;&#x79F0;
              season: &apos;&apos;, // &#x5B63;&#x8282;
              colorNo: item1[2][index2], // &#x989C;&#x8272;&#x7F16;&#x53F7;
              colorName: colorNameIndex &gt; -1 ? this.colorNameCollectList[colorNameIndex][2] : &apos;&apos;, // &#x989C;&#x8272;&#x540D;&#x79F0;
              optionNo: item1[3][index2], // &#x5206;&#x7EC4;&#x53F7;
              composition: &apos;&apos;, // &#x6210;&#x5206;
              price: &apos;&apos;, // &#x5355;&#x4EF7;
              costType: &apos;&apos;, // &#x5E01;&#x79CD;
              invoiceAveragePrice: &apos;&apos;, // &#x5E73;&#x5747;&#x5355;&#x4EF7;
              timeDelivery: &apos;&apos;, // &#x4EA4;&#x671F;
              planningMarkets: planningMarkets ? planningMarkets.replace(/\s+\(.*?\)/g, &apos;&apos;) : &apos;&apos;, // &#x8D70;&#x8D27;&#x56FD;&#x5BB6;
              noOfPieces: this.noOfPieces, // &#x6BCF;&#x5361;&#x652F;&#x6570;
              termsOfDelivery: trimsOfDelivery.indexOf(countryShort) &gt; -1 ? this.termsDeliveryCollectList.join(&apos; &apos;) : &apos;&apos;, // &#x8D70;&#x8D27;&#x65B9;&#x5F0F;
              qty: countryIndex &gt; -1 &amp;&amp; colorIndex &gt; -1 ? this.colorTableCollectList[countryIndex][3 + colorIndex] : &apos;&apos;, // &#x8D70;&#x8D27;&#x6570;&#x91CF;
              quantity: item1[4][index2], // &#x5165;&#x888B;&#x6570;
              labelCode: this.miscellaneousStr // &#x5305;&#x6750;&#x4FE1;&#x606F;
            });
          });
        }
      })

      this.timeDeliveryCollectList.shift();
      resultList = resultList.map((item) =&gt; {
        // &#x83B7;&#x53D6;&#x5206;&#x7EC4;&#x7D22;&#x5F15;
        const i = this.optionCollectList.findIndex((item2) =&gt; item2.startsWith(item.optionNo));
        let season = &apos;&apos;;
        let composition = &apos;&apos;;
        let price = &apos;&apos;;
        let costType = &apos;&apos;;
        let invoiceAveragePrice = this.invoiceAveragePriceCollectList.length &gt; 0 &amp;&amp; this.invoiceAveragePriceCollectList[0].length &gt; 0 &amp;&amp; this.invoiceAveragePriceCollectList[0][1].length &gt; 0 ? this.invoiceAveragePriceCollectList[0][1][0] : &apos;&apos;;
        let timeDelivery = &apos;&apos;;
        if (i &gt; -1 &amp;&amp; this.seasonCollectList.length &gt;= i) {
          season = this.seasonCollectList[i] || &apos;&apos;;
        }
        if (i &gt; -1 &amp;&amp; this.compositionCollectList.length &gt;= i) {
          composition = this.compositionCollectList[i].length &gt; 0 ? this.compositionCollectList[i][0] : &apos;&apos;
        }
        if (invoiceAveragePrice) {
          price = invoiceAveragePrice.match(/.+(?=\s)/g) ? invoiceAveragePrice.match(/.+(?=\s)/g)[0] : &apos;&apos;;
          costType = invoiceAveragePrice.match(/(?&lt;=\s).*/g) ? invoiceAveragePrice.match(/(?&lt;=\s).*/g)[0] : &apos;&apos;;
        }
        return {
          ...item,
          season,
          composition,
          price,
          costType,
          invoiceAveragePrice,
          timeDelivery
        }
      }).map((item) =&gt; {
        const i = this.timeDeliveryCollectList.map((item2) =&gt; (item2[1])).findIndex((item2) =&gt; item.planningMarkets.match(/(?&lt;=\().*(?=\))/g) ? item2.indexOf(item.planningMarkets.match(/(?&lt;=\().*(?=\))/g)[0]) &gt; -1 : false);
        item.timeDelivery = i &gt; -1 ? this.timeDeliveryCollectList[i][0] : &apos;&apos;;
        return {
          ...item,
          timeDelivery: moment(new Date(item.timeDelivery)).subtract(&apos;3&apos;, &apos;days&apos;).format(&apos;YYYY/MM/DD&apos;)
        };
      });
      console.log(resultList);
      return Promise.resolve(resultList);
    }).catch((error) =&gt; {
      // &#x4E0A;&#x4F20;&#x5931;&#x8D25;
      // throw new Error(error);
      console.log(error);
    });
  }
}
</code></pre>
<footer class="page-footer"><span class="copyright">Copyright &#xA9; 951450262@qq.com 2021 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">&#x6587;&#x4EF6;&#x4FEE;&#x8BA2;&#x65F6;&#x95F4;&#xFF1A;
2022-09-19 09:41:21
</span></footer>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="ng-alain.html" class="navigation navigation-prev " aria-label="Previous page: ng-alain">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="PicGO安装与配置SMMS图床.html" class="navigation navigation-next " aria-label="Next page: PicGO安装与配置SMMS图床">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"pdf预览、文本获取及处理","level":"1.18.5","depth":2,"next":{"title":"PicGO安装与配置SMMS图床","level":"1.18.6","depth":2,"path":"shared/PicGO安装与配置SMMS图床.md","ref":"shared/PicGO安装与配置SMMS图床.md","articles":[]},"previous":{"title":"ng-alain","level":"1.18.4","depth":2,"path":"shared/ng-alain.md","ref":"shared/ng-alain.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-lunr","-search","search-plus","expandable-chapters","theme-comscore","tbfed-pagefooter","-highlight","prism-themes","code","expandable-chapters-small","github","my-toolbar","hide-element","accordion","livereload"],"root":"./doc","styles":{"website":"./styles/website.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"Copyright &copy 951450262@qq.com 2021","modify_label":"文件修订时间：","modify_format":"YYYY-MM-DD HH:mm:ss"},"github":{"url":"https://github.com/MrCodeFront/my-gitbook"},"livereload":{},"accordion":{},"code":{"copyButtons":true},"hide-element":{"elements":[".gitbook-link"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-comscore":{},"prism-themes":{},"expandable-chapters-small":{},"my-toolbar":{"buttons":[{"label":"下载PDF","icon":"fa fa-file-pdf-o","url":"http://localhost:4000/book.pdf","position":"left","text":"下载PDF","target":"_blank"}]},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"expandable-chapters":{},"search-plus":{}},"theme":"default","author":"lkf","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"CodeFront Document","language":"zh-hans","gitbook":"3.2.3","description":""},"file":{"path":"shared/pdf预览、文本获取及处理.md","mtime":"2022-09-19T01:41:21.969Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2023-12-11T04:32:28.396Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-my-toolbar/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-accordion/accordionSelector.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

